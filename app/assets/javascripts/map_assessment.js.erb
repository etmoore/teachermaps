    


    //////////////////////////////
    //
    // Filter Resources for Map
    //
    //////////////////////////////

    var timer;
    $("#maps_filter_resource_search").live('keyup input',function() {
        var form = $(this);
        // Prevents ajax request till N milliseconds 
        timer && clearTimeout(timer);
        timer = setTimeout(function(){ 
            form.submit();
        }, 500);
    });

    // Needed for browser compatibility 
    $('#maps_filter_resource_form').live('change', function() {
        $(this).submit();
    });

    $("#maps_filter_resource_form")
    .live("ajax:error", function(event, data, status, xhr) {
        pushFlash({message:"<%= I18n.t('resources.filter_failure') %>", state: 'success', fadeOut: 5000});
    })
    .live("ajax:success", function(event, data, status, xhr) {
        // Update the resources table
        $("#maps_map_assessments_resources_table").html(data);  
    });

    //////////////////////////////
    //
    // Adding/Removing Map Standards
    //
    //////////////////////////////


    $('#maps_map_assessments_resources_table .map_assessment_resource_selected').live("click", function(e) {

        // /ajax/map_assessments/:map_asssessment_id/map_resources/:map_resource_id/destroy
        var mapAssessmentId = $(this).attr('map-assessment-id');
        var resourceId = $(this).attr('resource-id'); 
        var actionUrl = '/ajax/map_assessments/'+mapAssessmentId+'/map_resources/'+resourceId+'/destroy'
        var resourceElem = $(this);

        console.log("Removing map resource to assessment: "+actionUrl)

        if(mapAssessmentId == undefined || resourceId == undefined) return false;

        $.ajax({
            url: actionUrl,
            dataType: 'html',
            success: function (response) {
                console.log("Removed map resource to assessment: "+actionUrl)
                $('#maps_list_map_assessments').html(response);

                resourceElem.attr('class','map_assessment_resource_default');
            },
            error: function (xhr, ajaxOptions, thrownError) {
                pushFlash({message:"Error removing resource to Map Assessment", state: 'error', fadeOut: 5000});
            }
        });  

        e.stopPropagation();
    });

    $('#maps_map_assessments_resources_table .map_assessment_resource_default').live("click", function(e) {
        
        // /ajax/map_assessments/:map_asssessment_id/map_resources/:map_resource_id/new
        var mapAssessmentId = $(this).attr('map-assessment-id');
        var resourceId = $(this).attr('resource-id'); 
        var actionUrl = '/ajax/map_assessments/'+mapAssessmentId+'/map_resources/'+resourceId+'/new'
        var resourceElem = $(this);

        console.log("Removing map resource to assessment: "+actionUrl)

        if(mapAssessmentId == undefined || resourceId == undefined) return false;

        $.ajax({
            url: actionUrl,
            dataType: 'html',
            success: function (response) {
                console.log("Added map resource to assessment: "+actionUrl)
                $('#maps_list_map_assessments').html(response);

                resourceElem.attr('class','map_assessment_resource_selected');
            },
            error: function (xhr, ajaxOptions, thrownError) {
                pushFlash({message:"Error adding resource to Map Assessment", state: 'error', fadeOut: 5000});
            }
        });   
        
        e.stopPropagation();
    });



















