$(document).ready(function() {    
   
    //////////////////////////////
    //
    // Add Unit Assessment to Map
    //
    //////////////////////////////


    $(document).on("click", '#create_map_assessment', function(e) {

        var userId = $('#user-id').val();
        var mapId = $('#map-id').val();
        var actionUrl = $(this).attr('action-url');

        if(userId == undefined || mapId == undefined || actionUrl == undefined) return false;

        console.log("Adding assessment to Map: " + mapId + " owned by " + userId + " via path " + actionUrl);

        $.ajax({
            data: { 
                'map_assessment': { 'user_id' : userId, 'map_id' : mapId }
            },
            type: 'POST',
            url: actionUrl,
            dataType: 'html',
            success: function (response) {
                $('#maps_list_map_assessments').html(response);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                pushFlash({message:"Error adding a Map Assessment", state: 'error', fadeOut: 5000});
            }
        });

        e.stopPropagation();
    });

    //////////////////////////////
    //
    // Remove Unit Assessment to Map
    //
    //////////////////////////////


    $(document)
    .on("ajax:error", ".maps_map_assessments_destroy", function(event, data, status, xhr) {
        pushFlash({message:"Error deleting Map Assessment", state: 'error', fadeOut: 5000});
    })
    .on("ajax:success", ".maps_map_assessments_destroy", function(event, data, status, xhr) {
        $('#maps_list_map_assessments').html(data);
    });

    $(document)
    .on("ajax:error", ".maps_map_assessments_show_resources", function(event, data, status, xhr) {
        pushFlash({message:"Error fetching Map Assessment resources", state: 'error', fadeOut: 5000});
    })
    .on("ajax:success", ".maps_map_assessments_show_resources", function(event, data, status, xhr) {
        $('#filter_map_resources_modal').html(data);        
    });


});