jQuery(function($) {    
    
    //////////////////////////////
    //
    // Filter Resources 
    //
    //////////////////////////////

    var timer;
    $("#filter_standards_search").live('keyup input',function() {
        var form = $(this);
        // Prevents ajax request till N milliseconds 
        timer && clearTimeout(timer);
        timer = setTimeout(function(){ 
            form.submit();
        }, 500);
    });

    // Needed for browser compatibility 
    $('#filter_standards_form').live('change', function() {
        $(this).submit();
    });

    $("#filter_standards_form")
    .live("ajax:error", function(event, data, status, xhr) {
        pushFlash({message:"<%= I18n.t('resources.filter_failure') %>", state: 'success', fadeOut: 5000});
    })
    .live("ajax:success", function(event, data, status, xhr) {
        // Update the resources table
        $("#standards_table").html(data);  
    });



    $('#standards_list .standard-selected').live("click", function(e) {
    
        var standardId = $(this).attr('standard-id');
        if(standardId == undefined) return false;

        // $.ajax({
        //   url: resourceURI,
        //   dataType: 'html'
        // }).done(function(data) {
        //   $('#show_resource_link_modal_body').html(data);
        //   $('#show_resource_link_modal').modal('show');
        // });   
        console.log("Removing Standard from Map: " + standardId);

        $(this).attr('class','standard-default');

        e.stopPropagation();
    });

    $('#standards_list .standard-default').live("click", function(e) {
    
        var standardId = $(this).attr('standard-id');
        if(standardId == undefined) return false;
    

        // $.ajax({
        //   url: resourceURI,
        //   dataType: 'html'
        // }).done(function(data) {
        //   $('#show_resource_link_modal_body').html(data);
        //   $('#show_resource_link_modal').modal('show');
        // });   
        console.log("Adding Standard from Map: " + standardId);

        $(this).attr('class','standard-selected');

        e.stopPropagation();
    });


    
});




